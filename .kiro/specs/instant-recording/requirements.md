# 需求文档

## 介绍

立即录制功能是一个集成到现有Web应用主界面的新模块，允许用户直接通过浏览器调用设备麦克风进行实时会议音频录制。录制完成后，系统会自动将音频文件提交到现有的AI分析处理管道，为用户生成会议纪要和行动项。该功能旨在提供无缝的录制体验，从录制到分析的全流程自动化处理。

## 需求

### 需求 1

**用户故事：** 作为用户，我希望在主页上能够快速找到并使用录制功能，这样我就可以立即开始录制会议音频。

#### 验收标准

1. WHEN 用户访问主页 THEN 系统 SHALL 显示一个清晰可见的"立即录制"功能入口
2. WHEN 用户查看主页界面 THEN "立即录制"按钮 SHALL 具有明显的视觉标识和易于理解的标签

### 需求 2

**用户故事：** 作为用户，我希望系统能够正确处理麦克风权限请求，这样我就可以安全地使用录制功能。

#### 验收标准

1. WHEN 用户首次点击"开始录制" THEN 浏览器 SHALL 弹出标准的麦克风权限请求对话框
2. IF 用户拒绝了麦克风权限 THEN 系统 SHALL 显示友好的提示信息，引导用户如何开启权限
3. WHEN 用户授予麦克风权限 THEN 系统 SHALL 立即开始录制过程

### 需求 3

**用户故事：** 作为用户，我希望在录制过程中能够清楚地了解录制状态，这样我就可以确认录制正在进行并控制录制过程。

#### 验收标准

1. WHEN 录制开始后 THEN 界面 SHALL 显示动态更新的计时器
2. WHEN 录制进行中 THEN 界面 SHALL 显示跳动的录音图标作为视觉反馈
3. WHEN 录制进行中 THEN 界面 SHALL 提供"停止录制"按钮
4. WHEN 录制进行中 THEN 系统 SHALL 显示录制时长（正向计时或倒计时）

### 需求 4

**用户故事：** 作为用户，我希望系统能够限制录制时长并提供适当的时间管理，这样我就可以在合理的时间范围内完成录制。

#### 验收标准

1. WHEN 录制开始 THEN 系统 SHALL 支持最长30分钟的录制时长
2. WHEN 录制时间接近30分钟限制 THEN 系统 SHALL 提供时间警告提示
3. WHEN 录制达到30分钟限制 THEN 系统 SHALL 自动停止录制

### 需求 5

**用户故事：** 作为用户，我希望能够主动控制录制的结束，这样我就可以在合适的时机停止录制。

#### 验收标准

1. WHEN 用户点击"停止录制"按钮 THEN 录音过程 SHALL 立即结束
2. WHEN 录制停止 THEN 系统 SHALL 立即停止音频数据采集
3. WHEN 录制停止 THEN 界面 SHALL 更新为录制完成状态

### 需求 6

**用户故事：** 作为用户，我希望录制的音频能够自动处理和上传，这样我就不需要手动处理音频文件。

#### 验收标准

1. WHEN 录制结束 THEN 系统 SHALL 自动将录音数据打包成音频文件（.webm格式）
2. WHEN 音频文件生成完成 THEN 系统 SHALL 自动触发现有的文件上传流程
3. WHEN 音频文件上传 THEN 系统 SHALL 自动触发现有的AI分析处理管道

### 需求 7

**用户故事：** 作为用户，我希望能够在主页上跟踪我的录音任务状态，这样我就可以了解分析进度。

#### 验收标准

1. WHEN 新的录音任务创建 THEN 任务 SHALL 出现在主页的"会议分析任务"列表中
2. WHEN 录音任务刚创建 THEN 任务初始状态 SHALL 为"上传中"或"排队中"
3. WHEN 任务状态发生变化 THEN 主页任务列表 SHALL 实时更新状态显示

### 需求 8

**用户故事：** 作为用户，我希望录制功能能够处理各种异常情况，这样我就可以获得稳定可靠的录制体验。

#### 验收标准

1. IF 录制过程中发生网络错误 THEN 系统 SHALL 显示错误提示并保留已录制的音频数据
2. IF 录制过程中麦克风断开 THEN 系统 SHALL 自动停止录制并提示用户
3. IF 浏览器不支持录制功能 THEN 系统 SHALL 显示兼容性提示信息